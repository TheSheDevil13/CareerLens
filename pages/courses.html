<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses - Career Lens</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../styles/main.css">
</head>
<body>

    <div class="courses-page page-container">
        <div class="container py-5">
            <!-- Page Header -->
            <div class="page-header text-center mb-5">
                <h1 class="display-4 gradient-text">Skill Development Courses</h1>
                <p class="lead">Master the skills you need for your dream career</p>
            </div>

            <!-- Course Filters -->
            <div class="course-filters mb-5">
                <div class="row">
                    <div class="col-md-3">
                        <select class="form-select" id="departmentFilter">
                            <option value="">All Departments</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="levelFilter">
                            <option value="">All Levels</option>
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="platformFilter">
                            <option value="">All Platforms</option>
                            <option value="udemy">Udemy</option>
                            <option value="coursera">Coursera</option>
                            <option value="edx">edX</option>
                            <option value="freecodecamp">freeCodeCamp</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <input type="text" class="form-control" placeholder="Search courses..." id="searchFilter">
                    </div>
                </div>
            </div>

            <!-- Course Grid -->
            <div class="course-grid" id="courseGrid">
                <!-- Courses loaded by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Courses functionality
        class Courses {
            constructor() {
                this.departments = window.appData?.departments || [];
                this.courses = this.getCourses();
                this.filteredCourses = [...this.courses];
                
                this.init();
            }
            
            init() {
                this.initDepartmentFilter();
                this.renderCourses();
                this.initFilters();
            }
            
            initDepartmentFilter() {
                const deptFilter = document.getElementById('departmentFilter');
                if (deptFilter && this.departments.length > 0) {
                    this.departments.forEach(dept => {
                        const option = document.createElement('option');
                        option.value = dept.name;
                        option.textContent = dept.name;
                        deptFilter.appendChild(option);
                    });
                }
            }
            
            getCourses() {
                // Generate courses based on career paths and their skills
                const courses = [];
                let courseId = 1;
                
                if (!this.departments || this.departments.length === 0) {
                    return this.getDefaultCourses();
                }
                
                this.departments.forEach(dept => {
                    if (dept.careerPaths) {
                        dept.careerPaths.forEach(path => {
                            // Create one comprehensive course per career path
                            const allSkills = path.skills.map(s => s.name);
                            courses.push({
                                id: courseId++,
                                title: `${path.title} - Complete Course`,
                                instructor: "Industry Expert",
                                platform: this.getRandomPlatform(),
                                department: dept.name,
                                careerPath: path.title,
                                level: path.difficulty.toLowerCase() === 'advanced' ? 'advanced' : 
                                       path.difficulty.toLowerCase() === 'intermediate' ? 'intermediate' : 'beginner',
                                duration: this.getDuration(path.timeToHire),
                                rating: (4.5 + Math.random() * 0.5).toFixed(1),
                                students: this.getRandomStudents(),
                                price: this.getRandomPrice(),
                                skills: allSkills
                            });
                        });
                    }
                });
                
                return courses.length > 0 ? courses : this.getDefaultCourses();
            }
            
            getDefaultCourses() {
                return [
                    {
                        id: 1,
                        title: "The Complete Web Developer Bootcamp 2024",
                        instructor: "Dr. Angela Yu",
                        platform: "Udemy",
                        department: "Computer Science & Engineering",
                        careerPath: "Full Stack Developer",
                        level: "beginner",
                        duration: "65 hours",
                        rating: 4.7,
                        students: "1,200,000+",
                        price: "$89.99",
                        skills: ["JavaScript", "React", "Node.js", "SQL"]
                    }
                ];
            }
            
            getRandomPlatform() {
                const platforms = ["Udemy", "Coursera", "edX", "LinkedIn Learning"];
                return platforms[Math.floor(Math.random() * platforms.length)];
            }
            
            getDuration(timeToHire) {
                // Convert timeToHire to course duration
                if (timeToHire.includes('2-4')) return "2-3 months";
                if (timeToHire.includes('3-5')) return "3-4 months";
                if (timeToHire.includes('4-6')) return "4-5 months";
                if (timeToHire.includes('6-12')) return "6-9 months";
                return "3-6 months";
            }
            
            getRandomStudents() {
                const counts = ["50,000+", "100,000+", "250,000+", "500,000+", "1,000,000+"];
                return counts[Math.floor(Math.random() * counts.length)];
            }
            
            getRandomPrice() {
                const prices = ["$89.99", "$49/month", "$99.99", "Free", "$79.99"];
                return prices[Math.floor(Math.random() * prices.length)];
            }
            
            renderCourses() {
                const container = document.getElementById('courseGrid');
                if (!container) return;
                
                container.innerHTML = this.filteredCourses.map(course => `
                    <div class="course-card mb-4">
                        <div class="course-header">
                            <div class="course-badge">${course.platform}</div>
                            <div class="course-rating">
                                <i class="fas fa-star"></i> ${course.rating}
                                <small>(${course.students})</small>
                            </div>
                        </div>
                        <div class="course-body">
                            <h4 class="course-title">${course.title}</h4>
                            <p class="course-instructor">By ${course.instructor}</p>
                            <div class="course-meta">
                                <span><i class="fas fa-clock"></i> ${course.duration}</span>
                                <span><i class="fas fa-signal"></i> ${course.level}</span>
                                <span><i class="fas fa-building"></i> ${course.department || 'General'}</span>
                            </div>
                            ${course.careerPath ? `<p class="text-muted small mb-2"><i class="fas fa-road"></i> Career Path: ${course.careerPath}</p>` : ''}
                            <div class="course-skills">
                                ${course.skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('')}
                            </div>
                        </div>
                        <div class="course-footer">
                            <span class="course-price">${course.price}</span>
                            <button class="btn btn-gradient" onclick="courses.enrollCourse(${course.id})">
                                Enroll Now
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            initFilters() {
                // Department filter
                const deptFilter = document.getElementById('departmentFilter');
                if (deptFilter) {
                    deptFilter.addEventListener('change', (e) => {
                        this.applyFilters();
                    });
                }
                
                // Level filter
                const levelFilter = document.getElementById('levelFilter');
                if (levelFilter) {
                    levelFilter.addEventListener('change', (e) => {
                        this.applyFilters();
                    });
                }
                
                // Platform filter
                const platformFilter = document.getElementById('platformFilter');
                if (platformFilter) {
                    platformFilter.addEventListener('change', (e) => {
                        this.applyFilters();
                    });
                }
                
                // Search filter
                const searchFilter = document.getElementById('searchFilter');
                if (searchFilter) {
                    searchFilter.addEventListener('input', (e) => {
                        this.applyFilters();
                    });
                }
            }
            
            applyFilters() {
                const department = document.getElementById('departmentFilter')?.value || '';
                const level = document.getElementById('levelFilter')?.value || '';
                const platform = document.getElementById('platformFilter')?.value || '';
                const search = document.getElementById('searchFilter')?.value.toLowerCase() || '';
                
                this.filteredCourses = this.courses.filter(course => {
                    // Department filter
                    if (department && course.department !== department) return false;
                    
                    // Level filter
                    if (level && course.level !== level) return false;
                    
                    // Platform filter
                    if (platform && course.platform.toLowerCase() !== platform) return false;
                    
                    // Search filter
                    if (search) {
                        const searchable = `${course.title} ${course.instructor} ${course.skills.join(' ')} ${course.careerPath || ''}`.toLowerCase();
                        if (!searchable.includes(search)) return false;
                    }
                    
                    return true;
                });
                
                this.renderCourses();
            }
            
            enrollCourse(courseId) {
                const course = this.courses.find(c => c.id === courseId);
                if (course) {
                    alert(`Enrolling in: ${course.title}\n\nYou will be redirected to ${course.platform} to complete enrollment.`);
                    // In a real application, this would redirect to the course platform
                }
            }
        }
        
        // Initialize courses
        document.addEventListener('DOMContentLoaded', () => {
            window.courses = new Courses();
        });
    </script>

    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button id="themeToggle" class="btn btn-sm">
            <i class="fas fa-moon"></i>
            <i class="fas fa-sun"></i>
        </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../scripts/navigation.js"></script>
    <script src="../scripts/theme-manager.js"></script>
    <script src="../scripts/dummy-data.js"></script>
</body>
</html>